<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kurye & Ä°ÅŸletme Takip</title>
<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>

<style>
:root{
  --bg:#0f172a; --card:#1e293b; --soft:#334155;
  --blue:#3b82f6; --red:#ef4444; --green:#22c55e; --text:#e5e7eb;
}
*{box-sizing:border-box;}
body{background:var(--bg);color:var(--text);font-family:sans-serif;padding:10px;}
input, select, button{border:none;border-radius:8px;padding:8px;margin:4px 0;}
input, select{background:var(--soft);color:#fff;}
button{background:var(--blue);color:#fff;font-weight:bold;}
button.warn{background:#facc15;color:#000;}
button.small{padding:4px 6px;font-size:12px;}
.card{background:var(--card);padding:10px;border-radius:10px;margin-bottom:10px;}
.tabbar{display:flex;gap:6px;margin-bottom:10px;}
.tabbar button{flex:1;padding:10px;font-weight:bold;}
.active{background:var(--blue);}
.hidden{display:none;}
table{width:100%;border-collapse:collapse;font-size:12px;margin-top:6px;}
th, td{padding:6px;border-bottom:1px solid var(--soft);text-align:center;}
.logo{text-align:center;font-size:48px;margin:5px 0;}
.input-row{display:flex;gap:6px;flex-wrap:wrap;}
.input-row input{flex:1;}
.footer-buttons{display:flex;gap:6px;margin-top:10px;}
</style>
</head>

<body>

<div class="logo" id="logo">ğŸ›µ</div>

<div class="tabbar">
 <button onclick="tab('kurye')" class="active">ğŸ›µ KURYELER</button>
 <button onclick="tab('isletme')">ğŸ• Ä°ÅLETMELER</button>
</div>

<div id="kurye"></div>
<div id="isletme" class="hidden"></div>

<div class="footer-buttons">
 <button class="warn" style="flex:1;" onclick="gunSonu()">GÃœN SONU AL</button>
 <button style="flex:1;" onclick="excelAktar()">ğŸ“Š EXCEL AKTAR</button>
</div>

<script>
let data = JSON.parse(localStorage.getItem("takip")) || {kurye:[], isletme:[]};
let devir = JSON.parse(localStorage.getItem("devir")) || {kurye:[], isletme:[]};

// INPUT SABÄ°T TUTMA
let inputState = {
 kurye:{ad:"",paket:"",ucret:""},
 isletme:{ad:"",paket:"",ucret:""}
};

function save(){
 localStorage.setItem("takip",JSON.stringify(data));
 localStorage.setItem("devir",JSON.stringify(devir));
 render();
}

function tab(x){
 document.getElementById("kurye").classList.add("hidden");
 document.getElementById("isletme").classList.add("hidden");
 document.getElementById(x).classList.remove("hidden");
 logo.innerText = x==="kurye"?"ğŸ›µ":"ğŸ•";
}

function ekle(t){
 let s=inputState[t];
 if(!s.ad) return alert("Ä°sim gir");

 data[t].push({
  ad:s.ad,
  paket:+s.paket||0,
  ucret:+s.ucret||0,
  tutar:(+s.paket||0)*(+s.ucret||0)
 });
 save();
}

function gunSonu(){
 ["kurye","isletme"].forEach(t=>{
  let m={};
  data[t].forEach(x=>m[x.ad]=(m[x.ad]||0)+x.tutar);
  Object.entries(m).forEach(([ad,top])=>{
   let d=devir[t].find(x=>x.ad===ad);
   d?d.tutar+=top:devir[t].push({ad,tutar:top});
  });
  data[t]=[];
 });
 save();
}

function tabloGunluk(arr){
 if(arr.length===0) return "<i>GÃ¼nlÃ¼k kayÄ±t yok</i>";
 return `<table>
 <tr><th>Ad</th><th>Paket</th><th>Ãœcret</th><th>Toplam</th></tr>`+
 arr.map(x=>`
 <tr>
  <td>${x.ad}</td>
  <td>${x.paket}</td>
  <td>${x.ucret}</td>
  <td>${x.tutar}</td>
 </tr>`).join("")+`</table>`;
}

function tabloDevir(arr){
 if(arr.length===0) return "<i>Devir yok</i>";
 return `<table>
 <tr><th>Ad</th><th>Tutar</th></tr>`+
 arr.map(x=>`
 <tr>
  <td>${x.ad}</td>
  <td>${x.tutar}</td>
 </tr>`).join("")+`</table>`;
}

function excelAktar(){
 let wb=XLSX.utils.book_new();
 XLSX.utils.book_append_sheet(wb,XLSX.utils.json_to_sheet(data.kurye),"GUNLUK_KURYE");
 XLSX.utils.book_append_sheet(wb,XLSX.utils.json_to_sheet(data.isletme),"GUNLUK_ISLETME");
 XLSX.utils.book_append_sheet(
  wb,
  XLSX.utils.json_to_sheet([
   ...devir.kurye.map(x=>({Tip:"Kurye",Ad:x.ad,Tutar:x.tutar})),
   ...devir.isletme.map(x=>({Tip:"Ä°ÅŸletme",Ad:x.ad,Tutar:x.tutar}))
  ]),
  "DEVIR"
 );
 XLSX.writeFile(wb,"kurye_takip.xlsx");
}

function render(){
 kurye.innerHTML=`
 <div class="card">
  <b>GÃœNLÃœK KURYE</b>
  <div class="input-row">
   <input placeholder="Kurye" value="${inputState.kurye.ad}"
    oninput="inputState.kurye.ad=this.value">
   <input type="number" placeholder="Paket" value="${inputState.kurye.paket}"
    oninput="inputState.kurye.paket=this.value">
   <input type="number" placeholder="Ãœcret" value="${inputState.kurye.ucret}"
    oninput="inputState.kurye.ucret=this.value">
   <button onclick="ekle('kurye')">EKLE</button>
  </div>
  ${tabloGunluk(data.kurye)}
  <hr>
  <b>DEVÄ°R</b>
  ${tabloDevir(devir.kurye)}
 </div>
 `;

 isletme.innerHTML=`
 <div class="card">
  <b>GÃœNLÃœK Ä°ÅLETME</b>
  <div class="input-row">
   <input placeholder="Ä°ÅŸletme" value="${inputState.isletme.ad}"
    oninput="inputState.isletme.ad=this.value">
   <input type="number" placeholder="Paket" value="${inputState.isletme.paket}"
    oninput="inputState.isletme.paket=this.value">
   <input type="number" placeholder="Ãœcret" value="${inputState.isletme.ucret}"
    oninput="inputState.isletme.ucret=this.value">
   <button onclick="ekle('isletme')">EKLE</button>
  </div>
  ${tabloGunluk(data.isletme)}
  <hr>
  <b>DEVÄ°R</b>
  ${tabloDevir(devir.isletme)}
 </div>
 `;
}
render();
</script>

</body>
</html>
