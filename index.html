<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kurye Takip Final</title>
<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>

<style>
body{
  background:#0f172a;
  color:#f1f5f9;
  font-family:sans-serif;
  margin:0;
  padding:15px;
  display:flex;
  justify-content:center;
}
.container{width:100%;max-width:900px;}
h2{
  font-size:17px;
  color:#38bdf8;
  border-bottom:1px solid #334155;
  padding-bottom:5px;
  margin-top:20px;
}
.section{
  padding:10px 0;
  margin-bottom:15px;
  border-bottom:1px solid #334155;
}
input,button{
  width:100%;
  padding:10px;
  margin:5px 0;
  border-radius:6px;
  border:none;
  font-size:14px;
}
input{background:#334155;color:#f1f5f9;}
button{
  background:#3b82f6;
  color:#fff;
  font-weight:bold;
  cursor:pointer;
}
button.warn{background:#facc15;color:#000;}
button.danger{background:#ef4444;}
table{
  width:100%;
  border-collapse:collapse;
  margin-top:10px;
  font-size:13px;
}
th,td{
  border-bottom:1px solid #334155;
  padding:8px;
  text-align:center;
}
th{color:#7dd3fc;}
.isletmeCell{
  display:flex;
  align-items:center;
  justify-content:center;
  gap:6px;
}
.status{
  width:10px;
  height:10px;
  border-radius:50%;
  background:#ef4444;
}
.action-col{
  display:flex;
  flex-direction:column;
  gap:4px;
}
.action-col button{
  padding:6px;
  font-size:12px;
}
</style>
</head>

<body onload="yenile()">

<div class="container">

<h2>â• GÃ¼nlÃ¼k KayÄ±t</h2>
<div class="section">
  <input id="isletme" placeholder="Ä°ÅŸletme adÄ±">
  <input id="tutar" type="number" placeholder="Tutar">
  <button onclick="ekle()">Ekle</button>
</div>

<h2>ğŸ”„ Ä°ÅŸlemler</h2>
<div class="section">
  <button onclick="excel()">ğŸ“Š Excel Aktar</button>
</div>

<h2>ğŸ’¸ BorÃ§lular</h2>
<div class="section">
<table>
<thead>
<tr>
  <th>Ä°ÅŸletme</th>
  <th>Tutar</th>
  <th>Ä°ÅŸlem</th>
</tr>
</thead>
<tbody id="liste"></tbody>
</table>
</div>

</div>

<script>
let veriler = JSON.parse(localStorage.getItem("kuryeFinal")) || [];

function kaydet(){
  localStorage.setItem("kuryeFinal", JSON.stringify(veriler));
}

function yenile(){
  const tbody = document.getElementById("liste");
  tbody.innerHTML = "";

  veriler
    .filter(v => v.tutar > 0)
    .forEach((v,i)=>{
      tbody.innerHTML += `
      <tr>
        <td class="isletmeCell">
          <span class="status"></span>${v.isletme}
        </td>
        <td>${v.tutar} â‚º</td>
        <td>
          <div class="action-col">
            <button onclick="gunlukKayitDuzelt(${i})">âœï¸ KayÄ±t</button>
            <button onclick="gunlukDevirDuzelt(${i})">ğŸ”„ Devir</button>
            <button class="warn" onclick="gunlukDevirSil(${i})">ğŸ—‘ Devir</button>
            <button class="danger" onclick="gunlukKayitSil(${i})">âŒ KayÄ±t</button>
          </div>
        </td>
      </tr>
      `;
    });
}

function ekle(){
  const isletme = document.getElementById("isletme").value.trim();
  const tutar = Number(document.getElementById("tutar").value);

  if(!isletme || tutar<=0){
    alert("Bilgileri gir");
    return;
  }

  const kayit = veriler.find(v=>v.isletme===isletme);
  if(kayit){
    kayit.tutar += tutar;
  }else{
    veriler.push({isletme,tutar});
  }

  document.getElementById("isletme").value="";
  document.getElementById("tutar").value="";
  kaydet();
  yenile();
}

function gunlukKayitDuzelt(i){
  let yeni = prompt("GÃ¼nlÃ¼k kayÄ±t tutarÄ±:", veriler[i].tutar);
  if(yeni===null) return;
  veriler[i].tutar = Number(yeni);
  kaydet();
  yenile();
}

function gunlukKayitSil(i){
  if(confirm("GÃ¼nlÃ¼k kayÄ±t silinsin mi?")){
    veriler.splice(i,1);
    kaydet();
    yenile();
  }
}

function gunlukDevirDuzelt(i){
  let yeni = prompt("Devir tutarÄ±:", veriler[i].tutar);
  if(yeni===null) return;
  veriler[i].tutar = Number(yeni);
  kaydet();
  yenile();
}

function gunlukDevirSil(i){
  if(confirm("Devir sÄ±fÄ±rlansÄ±n mÄ±?")){
    veriler[i].tutar = 0;
    kaydet();
    yenile();
  }
}

function excel(){
  const ws = XLSX.utils.json_to_sheet(veriler);
  const wb = XLSX.utils.book_new();
  XLSX.utils.book_append_sheet(wb, ws, "Kurye");
  XLSX.writeFile(wb, "kurye_takip.xlsx");
}
</script>

</body>
</html>
