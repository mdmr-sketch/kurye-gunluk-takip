<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kurye & Ä°ÅŸletme Takip</title>

<style>
:root{
 --bg:#0f172a;--card:#1e293b;--soft:#334155;
 --blue:#3b82f6;--red:#ef4444;--green:#22c55e;--text:#e5e7eb
}
*{box-sizing:border-box}
body{background:var(--bg);color:var(--text);font-family:sans-serif;padding:10px}
button,input,select{width:100%;padding:8px;margin:4px 0;border:none;border-radius:8px}
input,select{background:var(--soft);color:#fff}
button{background:var(--blue);color:#fff;font-weight:bold}
.card{background:var(--card);padding:10px;border-radius:10px;margin-bottom:10px}
.tabbar{display:flex;gap:6px;margin-bottom:10px}
.tabbar button{flex:1}
.active{background:var(--blue)}
.hidden{display:none}
table{width:100%;font-size:12px;border-collapse:collapse;margin-top:6px}
th,td{padding:6px;border-bottom:1px solid var(--soft);text-align:center}
.icon{width:8px;height:8px;border-radius:50%;display:inline-block}
.red{background:var(--red)}
.blue{background:var(--blue)}
.green{background:var(--green)}
.actions{display:flex;gap:6px;justify-content:center}
.actions button{width:auto;padding:4px 6px;background:#475569}

/* ===== TOPLAM & MÄ°NÄ° GRAFÄ°K ===== */
.summary{
 display:grid;
 grid-template-columns:1fr 1fr;
 gap:10px;
 margin-top:10px;
}
.summary-card{
 background:#020617;
 padding:12px;
 border-radius:14px;
 box-shadow:0 0 0 1px #1e293b inset;
}
.summary-head{
 display:flex;
 align-items:center;
 gap:10px;
}
.summary-icon{font-size:26px}
.summary-text{font-size:12px;opacity:.8}
.summary-amount{font-size:20px;font-weight:bold}

.bar{
 margin-top:8px;
 height:8px;
 background:#334155;
 border-radius:10px;
 overflow:hidden;
}
.bar span{
 display:block;
 height:100%;
 width:0%;
 transition:.4s;
}
.bar.red span{background:var(--red)}
.bar.green span{background:var(--green)}

@media(max-width:600px){
 .summary{grid-template-columns:1fr}
}
</style>
</head>

<body>

<div class="tabbar">
 <button id="tKurye" class="active" onclick="tab('kurye')">ğŸ›µ KURYELER</button>
 <button id="tIsletme" onclick="tab('isletme')">ğŸ• Ä°ÅLETMELER</button>
</div>

<div id="kurye"></div>
<div id="isletme" class="hidden"></div>

<!-- Ã–DEME -->
<div class="card">
 <b>ğŸ’³ Ã–DEME GÄ°RÄ°ÅÄ°</b>

 <select id="odemeTip">
  <option value="kurye">Kurye</option>
  <option value="isletme">Ä°ÅŸletme</option>
 </select>

 <select id="odemeAd"></select>
 <input type="number" id="odemeTutar" placeholder="Ã–deme TutarÄ±">
 <button onclick="odemeGir()">Ã–DEME YAP</button>

 <!-- TOPLAM + MÄ°NÄ° GRAFÄ°K -->
 <div class="summary">
  <div class="summary-card">
   <div class="summary-head">
    <div class="summary-icon">ğŸ›µ</div>
    <div>
     <div class="summary-text">Kuryelere Ã–denecek</div>
     <div class="summary-amount" id="topKurye">0 â‚º</div>
    </div>
   </div>
   <div class="bar red"><span id="barKurye"></span></div>
  </div>

  <div class="summary-card">
   <div class="summary-head">
    <div class="summary-icon">ğŸ•</div>
    <div>
     <div class="summary-text">Ä°ÅŸletmelerden AlÄ±nacak</div>
     <div class="summary-amount" id="topIsletme">0 â‚º</div>
    </div>
   </div>
   <div class="bar green"><span id="barIsletme"></span></div>
  </div>
 </div>
</div>

<b>Ã–deme Tablosu</b>
<div id="odemeTablo"></div>

<button onclick="gunSonu()">GÃœN SONU AL</button>
<button onclick="excelAktar()">EXCEL DIÅA AKTAR</button>

<script>
let data=JSON.parse(localStorage.getItem("takip"))||{kurye:[],isletme:[]}
let devir=JSON.parse(localStorage.getItem("devir"))||{kurye:[],isletme:[]}
let odemeler=JSON.parse(localStorage.getItem("odemeler"))||[]

function save(){
 localStorage.setItem("takip",JSON.stringify(data))
 localStorage.setItem("devir",JSON.stringify(devir))
 localStorage.setItem("odemeler",JSON.stringify(odemeler))
 render()
}

function tab(x){
 kurye.classList.add("hidden")
 isletme.classList.add("hidden")
 tKurye.classList.remove("active")
 tIsletme.classList.remove("active")
 document.getElementById(x).classList.remove("hidden")
 document.getElementById("t"+x.charAt(0).toUpperCase()+x.slice(1)).classList.add("active")
 render()
}

function icon(v){ if(v>0) return "red"; if(v<0) return "blue"; return "green" }

function ekle(type,ad,p,u){
 if(!ad) return alert("Ä°sim gir")
 data[type].push({ad,paket:+p||0,tutar:(+p||0)*(+u||0)})
 save()
}

function sil(type,i,g){
 if(confirm("Silinsin mi?")){
  g?data[type].splice(i,1):devir[type].splice(i,1)
  save()
 }
}

function duzenle(type,i,g){
 let a=g?data[type]:devir[type]
 let t=prompt("Yeni tutar",a[i].tutar)
 if(t!==null){a[i].tutar=+t||0;save()}
}

function gunSonu(){
 ["kurye","isletme"].forEach(t=>{
  let m={}
  data[t].forEach(x=>m[x.ad]=(m[x.ad]||0)+x.tutar)
  Object.entries(m).forEach(([ad,top])=>{
   let d=devir[t].find(x=>x.ad===ad)
   d?d.tutar+=top:devir[t].push({ad,tutar:top})
  })
  data[t]=[]
 })
 save()
}

function odemeGir(){
 let tip=odemeTip.value
 let ad=odemeAd.value
 let tutar=+odemeTutar.value
 if(!ad||!tutar) return alert("Eksik bilgi")
 let d=devir[tip].find(x=>x.ad===ad)
 if(d) d.tutar=Math.max(0,d.tutar-tutar)
 odemeler.push({tarih:new Date().toLocaleDateString("tr-TR"),tip,ad,tutar})
 save()
}

function tablo(type,arr,g){
 return `<table>
 <tr><th></th><th>Ad</th>${g?"<th>Paket</th>":""}<th>Tutar</th><th>Ä°ÅŸlem</th></tr>
 ${arr.map((x,i)=>`
 <tr>
 <td><span class="icon ${icon(x.tutar)}"></span></td>
 <td>${x.ad}</td>
 ${g?`<td>${x.paket}</td>`:""}
 <td>${x.tutar}</td>
 <td class="actions">
  <button onclick="duzenle('${type}',${i},${g})">âœï¸</button>
  <button onclick="sil('${type}',${i},${g})">ğŸ—‘ï¸</button>
 </td>
 </tr>`).join("")}
 </table>`
}

function tabloOdeme(){
 return `<table>
 <tr><th>Tarih</th><th>Tip</th><th>Ad</th><th>Tutar</th></tr>
 ${odemeler.map(o=>`
 <tr><td>${o.tarih}</td><td>${o.tip}</td><td>${o.ad}</td><td>${o.tutar}</td></tr>`).join("")}
 </table>`
}

function excelAktar(){ alert("Excel yarÄ±n ğŸ‘") }

function render(){
 kurye.innerHTML=`
 <div style="text-align:center;font-size:40px">ğŸ›µ</div>
 <div class="card">
  <input id="ka" placeholder="Kurye adÄ±">
  <input type="number" placeholder="Paket" id="kp">
  <input type="number" placeholder="Ãœcret" id="ku">
  <button onclick="ekle('kurye',ka.value,kp.value,ku.value)">GÃœNLÃœK EKLE</button>
 </div>
 <b>GÃ¼nlÃ¼k</b>${tablo("kurye",data.kurye,true)}
 <b>Devir</b>${tablo("kurye",devir.kurye,false)}
`

 isletme.innerHTML=`
 <div style="text-align:center;font-size:40px">ğŸ•</div>
 <div class="card">
  <input id="ia" placeholder="Ä°ÅŸletme adÄ±">
  <input type="number" placeholder="Paket" id="ip">
  <input type="number" placeholder="Ãœcret" id="iu">
  <button onclick="ekle('isletme',ia.value,ip.value,iu.value)">GÃœNLÃœK EKLE</button>
 </div>
 <b>GÃ¼nlÃ¼k</b>${tablo("isletme",data.isletme,true)}
 <b>Devir</b>${tablo("isletme",devir.isletme,false)}
`

 let tKur=devir.kurye.reduce((a,b)=>a+b.tutar,0)
 let tIsl=devir.isletme.reduce((a,b)=>a+b.tutar,0)
 let max=Math.max(tKur,tIsl,1)

 topKurye.innerText=tKur+" â‚º"
 topIsletme.innerText=tIsl+" â‚º"
 barKurye.style.width=(tKur/max*100)+"%"
 barIsletme.style.width=(tIsl/max*100)+"%"

 odemeAd.innerHTML=""
 new Set(devir[odemeTip.value].map(x=>x.ad))
 .forEach(a=>odemeAd.add(new Option(a,a)))

 odemeTablo.innerHTML=tabloOdeme()
}

odemeTip.addEventListener("change",render)
render()
</script>

</body>
</html>
