<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kurye & Ä°ÅŸletme Takip</title>
<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>

<style>
:root{
 --bg:#0f172a;--card:#1e293b;--soft:#334155;
 --blue:#3b82f6;--red:#ef4444;--green:#22c55e;--text:#e5e7eb
}
*{box-sizing:border-box}
body{
 background:var(--bg);
 color:var(--text);
 font-family:sans-serif;
 padding:12px;
 max-width:720px;
 margin:auto
}
input,select,button{
 border:none;
 border-radius:10px;
 padding:10px;
 margin:4px 0
}
input,select{
 background:var(--soft);
 color:#fff
}
button{
 background:var(--blue);
 color:#fff;
 font-weight:bold;
 cursor:pointer
}
button.warn{background:#facc15;color:#000}
button.small{
 padding:4px 8px;
 font-size:12px
}
.card{
 background:var(--card);
 padding:12px;
 border-radius:14px;
 margin-bottom:14px;
 box-shadow:0 4px 12px rgba(0,0,0,.2)
}
.tabbar{
 display:flex;
 gap:8px;
 margin-bottom:12px
}
.tabbar button{flex:1}
.hidden{display:none}

.logo{
 text-align:center;
 font-size:46px;
 margin-bottom:8px
}

.input-row{
 display:flex;
 gap:6px;
 flex-wrap:wrap;
 align-items:end
}
.input-row input{flex:1;min-width:90px}

.section-title{
 margin:10px 0 4px;
 font-weight:bold;
 opacity:.9
}

table{
 width:100%;
 font-size:12px;
 border-collapse:collapse;
 margin-top:6px;
 background:#020617;
 border-radius:10px;
 overflow:hidden
}
th{
 background:#020617;
 padding:8px;
 font-size:11px;
 opacity:.8
}
td{
 padding:8px;
 border-bottom:1px solid var(--soft);
 text-align:center
}
tr:last-child td{border-bottom:none}

.actions button{margin:0 2px}

.summary{
 display:grid;
 grid-template-columns:1fr 1fr;
 gap:10px;
 margin-top:8px
}
.summary-card{
 background:#020617;
 padding:14px;
 border-radius:14px;
 font-size:14px
}
.pay{border-left:4px solid var(--red)}
.get{border-left:4px solid var(--green)}

.footer{
 display:flex;
 gap:8px;
 margin-top:10px
}
</style>
</head>

<body>

<div id="logo" class="logo">ğŸ›µ</div>

<div class="tabbar">
 <button onclick="tab('kurye')">ğŸ›µ KURYELER</button>
 <button onclick="tab('isletme')">ğŸ• Ä°ÅLETMELER</button>
</div>

<!-- KURYE -->
<div id="kurye">
 <div class="card">
  <div class="input-row">
   <input id="ka" placeholder="Kurye">
   <input id="kp" type="number" placeholder="Paket">
   <input id="ku" type="number" placeholder="Ãœcret">
   <button onclick="ekle('kurye')">EKLE</button>
  </div>
 </div>

 <div class="section-title">ğŸ“‹ GÃ¼nlÃ¼k Kurye</div>
 <div id="gunlukKurye"></div>

 <div class="section-title">ğŸ” Kurye Devir</div>
 <div id="devirKurye"></div>
</div>

<!-- ISLETME -->
<div id="isletme" class="hidden">
 <div class="card">
  <div class="input-row">
   <input id="ia" placeholder="Ä°ÅŸletme">
   <input id="ip" type="number" placeholder="Paket">
   <input id="iu" type="number" placeholder="Ãœcret">
   <button onclick="ekle('isletme')">EKLE</button>
  </div>
 </div>

 <div class="section-title">ğŸ“‹ GÃ¼nlÃ¼k Ä°ÅŸletme</div>
 <div id="gunlukIsletme"></div>

 <div class="section-title">ğŸ” Ä°ÅŸletme Devir</div>
 <div id="devirIsletme"></div>
</div>

<div class="card">
 <b>ğŸ’³ Ã–DEME</b><br>
 <select id="odemeTip" onchange="render()">
  <option value="kurye">Kurye</option>
  <option value="isletme">Ä°ÅŸletme</option>
 </select>
 <select id="odemeAd"></select>
 <input type="number" id="odemeTutar" placeholder="Tutar">
 <button onclick="odemeGir()">Ã–DEME YAP</button>

 <div class="summary">
  <div class="summary-card pay">Kuryelere<br><b id="topKurye">0 â‚º</b></div>
  <div class="summary-card get">Ä°ÅŸletmelerden<br><b id="topIsletme">0 â‚º</b></div>
 </div>
</div>

<div class="footer">
 <button class="warn" style="flex:1" onclick="gunSonu()">GÃœN SONU</button>
 <button style="flex:1" onclick="excelAktar()">ğŸ“¤ EXCEL</button>
</div>

<script>
let data = JSON.parse(localStorage.getItem("takip")) || {kurye:[],isletme:[]}
let devir = JSON.parse(localStorage.getItem("devir")) || {kurye:[],isletme:[]}

function save(){
 localStorage.setItem("takip",JSON.stringify(data))
 localStorage.setItem("devir",JSON.stringify(devir))
 render()
}
function tab(x){
 kurye.classList.add("hidden")
 isletme.classList.add("hidden")
 document.getElementById(x).classList.remove("hidden")
 logo.innerText = x==="kurye"?"ğŸ›µ":"ğŸ•"
}
function ekle(t){
 let a=document.getElementById(t==="kurye"?"ka":"ia")
 let p=document.getElementById(t==="kurye"?"kp":"ip")
 let u=document.getElementById(t==="kurye"?"ku":"iu")
 if(!a.value)return
 data[t].push({ad:a.value,paket:+p.value,ucret:+u.value,tutar:+p.value*+u.value})
 save()
}
function gunSonu(){
 ["kurye","isletme"].forEach(t=>{
  let m={}
  data[t].forEach(x=>m[x.ad]=(m[x.ad]||0)+x.tutar)
  Object.entries(m).forEach(([ad,top])=>{
   let d=devir[t].find(x=>x.ad===ad)
   d?d.tutar+=top:devir[t].push({ad,tutar:top})
  })
  data[t]=[]
 })
 save()
}
function odemeGir(){
 let t=odemeTip.value,a=odemeAd.value,tu=+odemeTutar.value
 if(!a||!tu)return
 let d=devir[t].find(x=>x.ad===a)
 if(d)d.tutar=Math.max(0,d.tutar-tu)
 save()
}
function tablo(arr,islem){
 if(!arr.length) return "<i>BoÅŸ</i>"
 return `<table>
 <tr>${Object.keys(arr[0]).map(k=>`<th>${k}</th>`).join("")}${islem?"<th></th>":""}</tr>
 ${arr.map((x,i)=>`
 <tr>
 ${Object.values(x).map(v=>`<td>${v}</td>`).join("")}
 ${islem?`<td class="actions">
 <button class="small" onclick="duzenle('${islem}',${i})">âœï¸</button>
 <button class="small" onclick="sil('${islem}',${i})">ğŸ—‘ï¸</button>
 </td>`:""}
 </tr>`).join("")}
 </table>`
}
function duzenle(t,i){
 let y=prompt("Yeni tutar",devir[t][i].tutar)
 if(y!==null){devir[t][i].tutar=+y||0;save()}
}
function sil(t,i){
 if(confirm("Silinsin mi?")){devir[t].splice(i,1);save()}
}
function excelAktar(){
 let wb=XLSX.utils.book_new()
 XLSX.utils.book_append_sheet(wb,XLSX.utils.json_to_sheet(data.kurye),"GUNLUK_KURYE")
 XLSX.utils.book_append_sheet(wb,XLSX.utils.json_to_sheet(data.isletme),"GUNLUK_ISLETME")
 XLSX.utils.book_append_sheet(wb,XLSX.utils.json_to_sheet([
  ...devir.kurye.map(x=>({Tip:"Kurye",Ad:x.ad,Tutar:x.tutar})),
  ...devir.isletme.map(x=>({Tip:"Ä°ÅŸletme",Ad:x.ad,Tutar:x.tutar}))
 ]),"DEVIR")
 XLSX.writeFile(wb,"kurye_takip.xlsx")
}
function render(){
 gunlukKurye.innerHTML = tablo(data.kurye)
 gunlukIsletme.innerHTML = tablo(data.isletme)
 devirKurye.innerHTML = tablo(devir.kurye,"kurye")
 devirIsletme.innerHTML = tablo(devir.isletme,"isletme")
 topKurye.innerText = devir.kurye.reduce((a,b)=>a+b.tutar,0)+" â‚º"
 topIsletme.innerText = devir.isletme.reduce((a,b)=>a+b.tutar,0)+" â‚º"
 odemeAd.innerHTML=""
 devir[odemeTip.value].forEach(x=>odemeAd.add(new Option(x.ad,x.ad)))
}
render()
</script>
</body>
</html>
