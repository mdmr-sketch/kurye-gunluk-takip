<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kurye & Ä°ÅŸletme Takip</title>
<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>

<style>
body{background:#0f172a;color:#f1f5f9;font-family:sans-serif;margin:0;padding:12px}
h2{font-size:16px;color:#38bdf8;margin:10px 0}
.tabs{display:flex;gap:5px}
.tabs button{flex:1}
input,button{width:100%;padding:10px;margin:4px 0;border:none;border-radius:6px;background:#334155;color:#f1f5f9}
button{background:#3b82f6;font-weight:bold}
button.warn{background:#facc15;color:#000}
button.danger{background:#ef4444}
table{width:100%;font-size:13px;border-collapse:collapse;margin-top:5px}
th,td{border-bottom:1px solid #334155;padding:6px;text-align:center}
.status{width:10px;height:10px;border-radius:50%;display:inline-block}
.red{background:#ef4444}
.green{background:#22c55e}
.blue{background:#3b82f6}
.hidden{display:none}
</style>
</head>

<body onload="yukle()">

<div class="tabs">
  <button onclick="sekme('kurye')">ğŸš´ Kurye</button>
  <button onclick="sekme('isletme')">ğŸª Ä°ÅŸletme</button>
</div>

<!-- KURYE -->
<div id="kurye">
<h2>Kurye GiriÅŸi</h2>
<input id="kAd" placeholder="Kurye AdÄ±">
<input id="kPaket" type="number" placeholder="Paket SayÄ±sÄ±">
<input id="kUcret" type="number" placeholder="Paket Ãœcreti">
<button onclick="kuryeEkle()">Ekle</button>

<table>
<thead><tr><th></th><th>Kurye</th><th>Ä°ÅŸ</th><th>Alacak</th><th></th></tr></thead>
<tbody id="kuryeListe"></tbody>
</table>
</div>

<!-- Ä°ÅLETME -->
<div id="isletme" class="hidden">
<h2>Ä°ÅŸletme Paket GiriÅŸi</h2>
<input id="iAd" placeholder="Ä°ÅŸletme AdÄ±">
<input id="iPaket" type="number" placeholder="Paket SayÄ±sÄ±">
<input id="iUcret" type="number" placeholder="Paket Ãœcreti">
<button onclick="isletmePaket()">Paket Ekle</button>

<h2>Ä°ÅŸletme Ã–deme GiriÅŸi</h2>
<input id="oAd" placeholder="Ä°ÅŸletme AdÄ±">
<input id="oTutar" type="number" placeholder="Ã–deme TutarÄ±">
<button class="warn" onclick="odemeEkle()">Ã–deme Al</button>

<table>
<thead><tr><th></th><th>Ä°ÅŸletme</th><th>BorÃ§</th><th></th></tr></thead>
<tbody id="isletmeListe"></tbody>
</table>
</div>

<button class="warn" onclick="gunSonu()">ğŸ“¤ GÃ¼n Sonu & Excel</button>

<script>
let kuryeler=JSON.parse(localStorage.getItem("kuryeler"))||[];
let isletmeler=JSON.parse(localStorage.getItem("isletmeler"))||[];

function kaydet(){
  localStorage.setItem("kuryeler",JSON.stringify(kuryeler));
  localStorage.setItem("isletmeler",JSON.stringify(isletmeler));
}

function yukle(){listele()}

function sekme(x){
  kurye.classList.toggle("hidden",x!=="kurye");
  isletme.classList.toggle("hidden",x!=="isletme");
}

function kuryeEkle(){
  let ad=kAd.value,p=+kPaket.value,u=+kUcret.value;
  if(!ad||!p||!u)return;
  kuryeler.push({ad,alacak:p*u});
  kaydet();listele();
}

function isletmePaket(){
  let ad=iAd.value,p=+iPaket.value,u=+iUcret.value;
  if(!ad||!p||!u)return;
  let x=isletmeler.find(i=>i.ad===ad);
  if(!x){x={ad,borc:0};isletmeler.push(x)}
  x.borc+=p*u;
  kaydet();listele();
}

function odemeEkle(){
  let ad=oAd.value,t=+oTutar.value;
  if(!ad||!t)return;
  let x=isletmeler.find(i=>i.ad===ad);
  if(!x)return alert("Ä°ÅŸletme bulunamadÄ±");
  x.borc-=t;
  if(x.borc<0)x.borc=0;
  kaydet();listele();
}

function listele(){
  kuryeListe.innerHTML="";
  kuryeler.forEach((k,i)=>{
    kuryeListe.innerHTML+=`
    <tr>
      <td><span class="status blue"></span></td>
      <td>${k.ad}</td>
      <td>-</td>
      <td>${k.alacak}</td>
      <td><button class="danger" onclick="kuryeler.splice(${i},1);kaydet();listele()">Sil</button></td>
    </tr>`;
  });

  isletmeListe.innerHTML="";
  isletmeler.forEach((i,x)=>{
    if(i.borc<=0)return;
    isletmeListe.innerHTML+=`
    <tr>
      <td><span class="status red"></span></td>
      <td>${i.ad}</td>
      <td>${i.borc}</td>
      <td><button class="danger" onclick="isletmeler.splice(${x},1);kaydet();listele()">Sil</button></td>
    </tr>`;
  });
}

function gunSonu(){
  let tarih=new Date().toLocaleDateString("tr-TR");
  let data=[];
  kuryeler.forEach(k=>data.push({Tarih:tarih,Tip:"Kurye",Ad:k.ad,Tutar:k.alacak}));
  isletmeler.forEach(i=>data.push({Tarih:tarih,Tip:"Ä°ÅŸletme",Ad:i.ad,Devir:i.borc}));
  let wb=XLSX.utils.book_new();
  let ws=XLSX.utils.json_to_sheet(data);
  XLSX.utils.book_append_sheet(wb,ws,tarih);
  XLSX.writeFile(wb,"kurye_isletme_takip.xlsx");
}
</script>

</body>
</html>
