<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kurye & Ä°ÅŸletme Takip</title>
<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>

<style>
body{background:#0f172a;color:#f1f5f9;font-family:sans-serif;margin:0;padding:12px}
h2{font-size:16px;color:#38bdf8;margin:10px 0}
.tabs{display:flex;gap:6px}
.tabs button{flex:1}
input,button{
  width:100%;padding:10px;margin:4px 0;border:none;border-radius:6px;
  background:#334155;color:#f1f5f9
}
button{background:#3b82f6;font-weight:bold}
button.warn{background:#facc15;color:#000}
button.danger{background:#ef4444}
button.edit{background:#64748b}

table{width:100%;font-size:13px;border-collapse:collapse;margin-top:6px}
th,td{border-bottom:1px solid #334155;padding:6px;text-align:center}

.status{width:10px;height:10px;border-radius:50%;display:inline-block}
.red{background:#ef4444}
.green{background:#22c55e}
.blue{background:#3b82f6}

.devir{font-size:11px;color:#facc15}

.hidden{display:none}

.actions button{
  padding:4px 6px;
  font-size:12px;
  margin:0 2px;
}
</style>
</head>

<body onload="listele()">

<div class="tabs">
  <button onclick="sekme('kurye')">ğŸš´ Kurye</button>
  <button onclick="sekme('isletme')">ğŸª Ä°ÅŸletme</button>
</div>

<!-- KURYE -->
<div id="kurye">
<h2>Kurye Paket GiriÅŸi</h2>
<input id="kAd" placeholder="Kurye AdÄ±">
<input id="kPaket" type="number" placeholder="Paket SayÄ±sÄ±">
<input id="kUcret" type="number" placeholder="Paket Ãœcreti">
<button onclick="kuryePaket()">Paket Ekle</button>

<h2>Kurye Ã–deme</h2>
<input id="kOdemeAd" placeholder="Kurye AdÄ±">
<input id="kOdeme" type="number" placeholder="Ã–deme TutarÄ±">
<button class="warn" onclick="kuryeOdeme()">Ã–deme Yap</button>

<table>
<thead>
<tr><th></th><th>Kurye</th><th>Alacak</th><th>Durum</th><th></th></tr>
</thead>
<tbody id="kuryeListe"></tbody>
</table>
</div>

<!-- Ä°ÅLETME -->
<div id="isletme" class="hidden">
<h2>Ä°ÅŸletme Paket GiriÅŸi</h2>
<input id="iAd" placeholder="Ä°ÅŸletme AdÄ±">
<input id="iPaket" type="number" placeholder="Paket SayÄ±sÄ±">
<input id="iUcret" type="number" placeholder="Paket Ãœcreti">
<button onclick="isletmePaket()">Paket Ekle</button>

<h2>Ä°ÅŸletme Ã–deme</h2>
<input id="iOdemeAd" placeholder="Ä°ÅŸletme AdÄ±">
<input id="iOdeme" type="number" placeholder="Ã–deme TutarÄ±">
<button class="warn" onclick="isletmeOdeme()">Ã–deme Al</button>

<table>
<thead>
<tr><th></th><th>Ä°ÅŸletme</th><th>BorÃ§</th><th>Durum</th><th></th></tr>
</thead>
<tbody id="isletmeListe"></tbody>
</table>
</div>

<button class="warn" onclick="gunSonu()">ğŸ“¤ GÃ¼n Sonu & Excel</button>

<script>
let kuryeler=JSON.parse(localStorage.getItem("kuryeler"))||[];
let isletmeler=JSON.parse(localStorage.getItem("isletmeler"))||[];

function kaydet(){
 localStorage.setItem("kuryeler",JSON.stringify(kuryeler));
 localStorage.setItem("isletmeler",JSON.stringify(isletmeler));
}

function sekme(x){
 kurye.classList.toggle("hidden",x!=="kurye");
 isletme.classList.toggle("hidden",x!=="isletme");
}

function kuryePaket(){
 let ad=kAd.value,p=+kPaket.value,u=+kUcret.value;
 if(!ad||!p||!u)return;
 let k=kuryeler.find(x=>x.ad===ad);
 if(!k){k={ad,alacak:0,devir:false};kuryeler.push(k)}
 k.alacak+=p*u; k.devir=false;
 kaydet();listele();
}

function kuryeOdeme(){
 let ad=kOdemeAd.value,t=+kOdeme.value;
 let k=kuryeler.find(x=>x.ad===ad);
 if(!k||!t)return;
 k.alacak-=t; if(k.alacak<0)k.alacak=0;
 kaydet();listele();
}

function isletmePaket(){
 let ad=iAd.value,p=+iPaket.value,u=+iUcret.value;
 if(!ad||!p||!u)return;
 let i=isletmeler.find(x=>x.ad===ad);
 if(!i){i={ad,borc:0,devir:false};isletmeler.push(i)}
 i.borc+=p*u; i.devir=false;
 kaydet();listele();
}

function isletmeOdeme(){
 let ad=iOdemeAd.value,t=+iOdeme.value;
 let i=isletmeler.find(x=>x.ad===ad);
 if(!i||!t)return;
 i.borc-=t; if(i.borc<0)i.borc=0;
 kaydet();listele();
}

function duzenleKurye(i){
 let t=prompt("Yeni alacak tutarÄ±:",kuryeler[i].alacak);
 if(t!==null){kuryeler[i].alacak=+t;kaydet();listele();}
}

function duzenleIsletme(i){
 let t=prompt("Yeni borÃ§ tutarÄ±:",isletmeler[i].borc);
 if(t!==null){isletmeler[i].borc=+t;kaydet();listele();}
}

function listele(){
 kuryeListe.innerHTML="";
 kuryeler.forEach((k,i)=>{
  let renk=k.alacak>0?"blue":"green";
  kuryeListe.innerHTML+=`
  <tr>
   <td><span class="status ${renk}"></span></td>
   <td>${k.ad}</td>
   <td>${k.alacak}</td>
   <td>${k.devir?'<span class="devir">DEVÄ°R</span>':''}</td>
   <td class="actions">
    <button class="edit" onclick="duzenleKurye(${i})">âœï¸</button>
    <button class="danger" onclick="kuryeler.splice(${i},1);kaydet();listele()">ğŸ—‘</button>
   </td>
  </tr>`;
 });

 isletmeListe.innerHTML="";
 isletmeler.forEach((i,x)=>{
  let renk=i.borc>0?"red":"green";
  isletmeListe.innerHTML+=`
  <tr>
   <td><span class="status ${renk}"></span></td>
   <td>${i.ad}</td>
   <td>${i.borc}</td>
   <td>${i.devir?'<span class="devir">DEVÄ°R</span>':''}</td>
   <td class="actions">
    <button class="edit" onclick="duzenleIsletme(${x})">âœï¸</button>
    <button class="danger" onclick="isletmeler.splice(${x},1);kaydet();listele()">ğŸ—‘</button>
   </td>
  </tr>`;
 });
}

function gunSonu(){
 let tarih=new Date().toLocaleDateString("tr-TR");
 let data=[];
 kuryeler.forEach(k=>{
  if(k.alacak>0){k.devir=true}
  data.push({Tarih:tarih,Tip:"Kurye",Ad:k.ad,Devir:k.alacak});
 });
 isletmeler.forEach(i=>{
  if(i.borc>0){i.devir=true}
  data.push({Tarih:tarih,Tip:"Ä°ÅŸletme",Ad:i.ad,Devir:i.borc});
 });
 let wb=XLSX.utils.book_new();
 let ws=XLSX.utils.json_to_sheet(data);
 XLSX.utils.book_append_sheet(wb,ws,tarih);
 XLSX.writeFile(wb,"kurye_isletme_takip.xlsx");
 kaydet();listele();
}
</script>

</body>
</html>
