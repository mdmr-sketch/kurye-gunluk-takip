<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kurye & İşletme Takip</title>
<style>
:root{
 --bg:#0f172a;--card:#1e293b;--soft:#334155;
 --blue:#3b82f6;--red:#ef4444;--green:#22c55e;--text:#e5e7eb
}
*{box-sizing:border-box}
body{background:var(--bg);color:var(--text);font-family:sans-serif;padding:10px}
button,input,select{width:100%;padding:8px;margin:4px 0;border:none;border-radius:8px}
input,select{background:var(--soft);color:#fff}
button{background:var(--blue);color:#fff;font-weight:bold}
.card{background:var(--card);padding:10px;border-radius:10px;margin-bottom:10px}
.tabbar{display:flex;gap:6px;margin-bottom:10px}
.tabbar button{flex:1}
.active{background:var(--blue)}
.hidden{display:none}
table{width:100%;font-size:12px;border-collapse:collapse;margin-top:6px}
th,td{padding:6px;border-bottom:1px solid var(--soft);text-align:center}
.total{
 background:#020617;
 font-weight:bold;
 color:#22c55e;
}
</style>
</head>
<body>

<div class="tabbar">
 <button id="tKurye" class="active" onclick="tab('kurye')">KURYELER</button>
 <button id="tIsletme" onclick="tab('isletme')">İŞLETMELER</button>
</div>

<div id="kurye"></div>
<div id="isletme" class="hidden"></div>

<script>
let data=JSON.parse(localStorage.getItem("takip"))||{kurye:[],isletme:[]}
let devir=JSON.parse(localStorage.getItem("devir"))||{kurye:[],isletme:[]}
let last={kurye:{p:'',u:''},isletme:{p:'',u:''}}

function save(){
 localStorage.setItem("takip",JSON.stringify(data))
 localStorage.setItem("devir",JSON.stringify(devir))
 render()
}

function tab(x){
 kurye.classList.add("hidden")
 isletme.classList.add("hidden")
 tKurye.classList.remove("active")
 tIsletme.classList.remove("active")
 document.getElementById(x).classList.remove("hidden")
 document.getElementById("t"+x.charAt(0).toUpperCase()+x.slice(1)).classList.add("active")
}

function ekle(type,ad,p,u){
 if(!ad) return alert("İsim gir")
 p=Number(p)||0; u=Number(u)||0
 last[type]={p,u}
 data[type].push({ad,paket:p,tutar:p*u})
 save()
}

function gunSonu(){
 ["kurye","isletme"].forEach(t=>{
  let map={}
  data[t].forEach(x=>map[x.ad]=(map[x.ad]||0)+x.tutar)
  Object.entries(map).forEach(([ad,top])=>{
   let d=devir[t].find(x=>x.ad===ad)
   if(d) d.tutar+=top
   else devir[t].push({ad,tutar:top})
  })
  data[t]=[]
 })
 save()
}

function toplam(type){
 let t=0
 data[type].forEach(x=>t+=x.tutar)
 devir[type].forEach(x=>t+=x.tutar)
 return t
}

function tablo(type){
 let rows=data[type].map(x=>`
 <tr>
  <td>${x.ad}</td>
  <td>${x.paket}</td>
  <td>${x.tutar}</td>
 </tr>`).join("")

 let dev=devir[type].map(x=>`
 <tr>
  <td>${x.ad}</td>
  <td>-</td>
  <td>${x.tutar}</td>
 </tr>`).join("")

 return `
 <table>
 <tr><th>Ad</th><th>Paket</th><th>Tutar</th></tr>
 ${rows}
 ${dev}
 <tr class="total">
  <td colspan="2">TOPLAM</td>
  <td>${toplam(type)}</td>
 </tr>
 </table>`
}

function render(){
 kurye.innerHTML=`
 <div class="card">
  <input id="ka" placeholder="Kurye adı">
  <input type="number" placeholder="Paket" value="${last.kurye.p}" id="kp">
  <input type="number" placeholder="Ücret" value="${last.kurye.u}" id="ku">
  <button onclick="ekle('kurye',ka.value,kp.value,ku.value)">GÜNLÜK EKLE</button>
 </div>
 <b>Kuryelere Ödenecek Toplam</b>
 ${tablo("kurye")}
 `

 isletme.innerHTML=`
 <div class="card">
  <input id="ia" placeholder="İşletme adı">
  <input type="number" placeholder="Paket" value="${last.isletme.p}" id="ip">
  <input type="number" placeholder="Ücret" value="${last.isletme.u}" id="iu">
  <button onclick="ekle('isletme',ia.value,ip.value,iu.value)">GÜNLÜK EKLE</button>
 </div>
 <b>İşletmelerden Alınacak Toplam</b>
 ${tablo("isletme")}
 `
}
render()
</script>

<button onclick="gunSonu()">GÜN SONU AL</button>

</body>
</html>
