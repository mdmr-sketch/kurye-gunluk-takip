<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kurye & Ä°ÅŸletme Takip â€“ Ã‡ekirdek</title>

<style>
body{background:#0f172a;color:#e5e7eb;font-family:sans-serif;margin:0;padding:10px}
.tabs{display:flex;gap:6px;margin-bottom:10px}
.tabs button{flex:1;padding:10px;border:none;border-radius:6px;font-weight:bold}
.active{background:#3b82f6;color:#fff}
.passive{background:#334155;color:#fff}

.section{border-bottom:1px solid #334155;padding-bottom:10px;margin-bottom:10px}
input,button{width:100%;padding:8px;margin:4px 0;border-radius:6px;border:none}
input{background:#334155;color:#fff}
button{background:#22c55e;color:#000;font-weight:bold}

.person{margin-bottom:12px}
.header{
 display:flex;
 justify-content:space-between;
 align-items:center;
 font-weight:bold;
}
.packages{font-size:13px;margin-left:10px;margin-top:4px}
.small{padding:2px 6px;font-size:11px}

.red{color:#ef4444}
.green{color:#22c55e}
.blue{color:#38bdf8}
</style>
</head>

<body onload="loadData()">

<div class="tabs">
  <button id="tKurye" class="active" onclick="showTab('kurye')">Kurye</button>
  <button id="tIsletme" class="passive" onclick="showTab('isletme')">Ä°ÅŸletme</button>
</div>

<!-- KURYE -->
<div id="kurye">
  <div class="section">
    <h3>Kurye DaÄŸÄ±tÄ±m</h3>
    <input id="k_ad" placeholder="Kurye AdÄ±">
    <input id="k_paket" type="number" placeholder="Paket">
    <input id="k_ucret" type="number" placeholder="Paket Ãœcreti">
    <button onclick="kuryeDagitim()">Ekle</button>
  </div>

  <div class="section">
    <h3>Kurye Ã–deme</h3>
    <input id="k_odeme_ad" placeholder="Kurye AdÄ±">
    <input id="k_odeme" type="number" placeholder="Ã–deme">
    <button onclick="kuryeOdeme()">Ã–deme Gir</button>
  </div>

  <div id="kuryeList"></div>
</div>

<!-- Ä°ÅLETME -->
<div id="isletme" style="display:none">
  <div class="section">
    <h3>Ä°ÅŸletme DaÄŸÄ±tÄ±m</h3>
    <input id="i_ad" placeholder="Ä°ÅŸletme AdÄ±">
    <input id="i_paket" type="number" placeholder="Paket">
    <input id="i_ucret" type="number" placeholder="Paket Ãœcreti">
    <button onclick="isletmeDagitim()">Ekle</button>
  </div>

  <div class="section">
    <h3>Ä°ÅŸletme Ã–deme</h3>
    <input id="i_odeme_ad" placeholder="Ä°ÅŸletme AdÄ±">
    <input id="i_odeme" type="number" placeholder="Ã–deme">
    <button onclick="isletmeOdeme()">Ã–deme Al</button>
  </div>

  <div id="isletmeList"></div>
</div>

<script>
let data = JSON.parse(localStorage.getItem("cekirdek")) || {kurye:{}, isletme:{}};
function save(){localStorage.setItem("cekirdek",JSON.stringify(data))}
function today(){return new Date().toISOString().split("T")[0]}

function showTab(t){
 kurye.style.display=t=="kurye"?"block":"none";
 isletme.style.display=t=="isletme"?"block":"none";
 tKurye.className=t=="kurye"?"active":"passive";
 tIsletme.className=t=="isletme"?"active":"passive";
}

function add(type,name,obj){
 if(!data[type][name]) data[type][name]=[];
 data[type][name].push(obj);
 save(); render();
}

/* EKLEME */
function kuryeDagitim(){
 add("kurye",k_ad.value,{tip:"dagitim",paket:+k_paket.value,ucret:+k_ucret.value,tarih:today()});
}
function kuryeOdeme(){
 add("kurye",k_odeme_ad.value,{tip:"odeme",miktar:+k_odeme.value,tarih:today()});
}
function isletmeDagitim(){
 add("isletme",i_ad.value,{tip:"dagitim",paket:+i_paket.value,ucret:+i_ucret.value,tarih:today()});
}
function isletmeOdeme(){
 add("isletme",i_odeme_ad.value,{tip:"odeme",miktar:+i_odeme.value,tarih:today()});
}

/* HESAPLAR */
function hesap(liste,isKurye){
 return liste.reduce((t,e)=>{
  if(e.tip=="dagitim") return t+(isKurye?-(e.paket*e.ucret):(e.paket*e.ucret));
  return t+(isKurye?e.miktar:-e.miktar);
 },0);
}

function gunlukPaketler(liste){
 let g={};
 liste.filter(e=>e.tip=="dagitim").forEach(e=>{
  g[e.tarih]=(g[e.tarih]||0)+e.paket;
 });
 return g;
}

/* EKRAN */
function render(){
 kuryeList.innerHTML=""; isletmeList.innerHTML="";

 for(let k in data.kurye){
  let b=hesap(data.kurye[k],true);
  let p=gunlukPaketler(data.kurye[k]);
  let icon=b>0?"ğŸ”µ":b<0?"ğŸ”´":"ğŸŸ¢";
  let cls=b>0?"blue":b<0?"red":"green";

  kuryeList.innerHTML+=`
  <div class="person ${cls}">
    <div class="header">
      ${icon} ${k} | ${b}â‚º
      <span>
        <button class="small" onclick="editAll('kurye','${k}')">âœï¸</button>
        <button class="small" onclick="delAll('kurye','${k}')">ğŸ—‘</button>
      </span>
    </div>
    <div class="packages">
      ${Object.entries(p).map(([t,v])=>`${t} â†’ ${v} paket`).join("<br>")}
    </div>
  </div>`;
 }

 for(let i in data.isletme){
  let b=hesap(data.isletme[i],false);
  let p=gunlukPaketler(data.isletme[i]);
  let icon=b>0?"ğŸ”´":"ğŸŸ¢";
  let cls=b>0?"red":"green";

  isletmeList.innerHTML+=`
  <div class="person ${cls}">
    <div class="header">
      ${icon} ${i} | ${b}â‚º
      <span>
        <button class="small" onclick="editAll('isletme','${i}')">âœï¸</button>
        <button class="small" onclick="delAll('isletme','${i}')">ğŸ—‘</button>
      </span>
    </div>
    <div class="packages">
      ${Object.entries(p).map(([t,v])=>`${t} â†’ ${v} paket`).join("<br>")}
    </div>
  </div>`;
 }
}

function delAll(t,n){
 if(!confirm("TÃ¼m kayÄ±tlar silinsin mi?"))return;
 delete data[t][n]; save(); render();
}
function editAll(t,n){
 alert("Detay dÃ¼zenleme bir sonraki adÄ±mda (kilit bozulmadan) eklenecek");
}

function loadData(){render()}
</script>

</body>
</html>
